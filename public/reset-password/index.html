<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Password Reset</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script>
      (function () {
        // Supabase sends access_token/refresh_token OR code, depending on your flow.
        const params = new URLSearchParams(window.location.search);
        const scheme = 'exp+new_ai_food_app'//'newaifoodapp'; // or 'exp+new_ai_food_app' for Expo Go
        // If you use PKCE for password recovery (PASSWORD_RECOVERY with code):
        const code = params.get('code');
        if (code) {
          window.location.replace(scheme + '://signin?code=' + encodeURIComponent(code));
          return;
        }
        // Else fallback: token-based (older flow)
        const access_token = params.get('access_token');
        const refresh_token = params.get('refresh_token');
        if (access_token && refresh_token) {
          window.location.replace(
            scheme + '://signin?access_token=' + encodeURIComponent(access_token) +
            '&refresh_token=' + encodeURIComponent(refresh_token)
          );
          return;
        }
        // Default
        window.location.replace(scheme + '://signin');
      })();
    </script>
  </head>
  <body>Redirecting...</body>
</html>
